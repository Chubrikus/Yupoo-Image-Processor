import parser
import new_postimg
import table
import to_izo
import get_string

# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'untitled.ui'
#
# Created by: PyQt5 UI code generator 5.15.6
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again. Do not edit this file unless you know what you are doing.


from PyQt5 import QtCore, QtGui, QtWidgets
from PyQt5.QtGui import QPixmap
from PyQt5.QtCore import QThread, pyqtSignal, QTimer
import sys
import threading
import time

host_img = []
inner = 4
f_img = []


class ImageLoaderThread(QThread):
    """–ü–æ—Ç–æ–∫ –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π"""
    image_loaded = pyqtSignal(int, str)  # –∏–Ω–¥–µ–∫—Å, –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É
    image_failed = pyqtSignal(int, str)  # –∏–Ω–¥–µ–∫—Å, –æ—à–∏–±–∫–∞
    progress_updated = pyqtSignal(int, str)  # –ø—Ä–æ–≥—Ä–µ—Å—Å, —Å—Ç–∞—Ç—É—Å
    
    def __init__(self, urls, use_proxy=True):
        super().__init__()
        self.urls = urls
        self.use_proxy = use_proxy
        self.running = True
        
    def run(self):
        for i, url in enumerate(self.urls):
            if not self.running:
                break
                
            self.progress_updated.emit(
                int((i / len(self.urls)) * 100), 
                f"–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è {i+1}/{len(self.urls)}..."
            )
            
            try:
                # –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                izo = to_izo.to_img(url)
                if izo is not None:
                    # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∏–º–µ–Ω–µ–º
                    filename = f"res_{i}.jpg"
                    izo.save(filename)
                    self.image_loaded.emit(i, filename)
                else:
                    self.image_failed.emit(i, "–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ")
            except Exception as e:
                self.image_failed.emit(i, str(e))
                
            # –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–≥—Ä—É–∑–∫–∞–º–∏
            time.sleep(0.1)
            
        self.progress_updated.emit(100, "–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!")
        
    def stop(self):
        self.running = False


class Ui_MainWindow(object):
    def setupUi(self, MainWindow):
        MainWindow.setObjectName("MainWindow")
        MainWindow.setGeometry(0, 0, 800, 250)
        self.centralwidget = QtWidgets.QWidget(MainWindow)
        self.centralwidget.setObjectName("centralwidget")
        
        # –î–æ–±–∞–≤–ª—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
        self.image_loader = None
        self.loaded_images = {}  # –°–ª–æ–≤–∞—Ä—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
        self.current_image_set = []  # –¢–µ–∫—É—â–∏–π –Ω–∞–±–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
        
        self.tabWidget = QtWidgets.QTabWidget(self.centralwidget)
        self.tabWidget.setGeometry(QtCore.QRect(10, 0, 791, 241))
        self.tabWidget.setObjectName("tabWidget")
        self.tab = QtWidgets.QWidget()

        self.tab.setObjectName("tab")
        self.textEdit_3 = QtWidgets.QTextEdit(self.tab)
        self.textEdit_3.setGeometry(QtCore.QRect(3, 30, 521, 181))
        self.textEdit_3.setObjectName("textEdit_3")
        self.label_9 = QtWidgets.QLabel(self.tab)
        self.label_9.setGeometry(QtCore.QRect(10, 10, 191, 16))
        self.label_9.setObjectName("label_9")
        self.tabWidget.addTab(self.tab, "")

        '''
        self.tab.setObjectName("tab")
        self.tableWidget = QtWidgets.QTableWidget(self.tab)
        self.tableWidget.setGeometry(QtCore.QRect(10, 20, 771, 141))
        self.tableWidget.setObjectName("tableWidget")
        self.tableWidget.setColumnCount(12)
        self.tableWidget.setRowCount(3)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(1, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(2, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setHorizontalHeaderItem(0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setHorizontalHeaderItem(1, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setHorizontalHeaderItem(2, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setHorizontalHeaderItem(3, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setHorizontalHeaderItem(4, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setHorizontalHeaderItem(5, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setHorizontalHeaderItem(6, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setHorizontalHeaderItem(7, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setHorizontalHeaderItem(8, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setHorizontalHeaderItem(9, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setHorizontalHeaderItem(10, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setHorizontalHeaderItem(11, item)
        self.pushButton = QtWidgets.QPushButton(self.tab)
        self.pushButton.setGeometry(QtCore.QRect(160, 172, 91, 31))
        self.pushButton.setObjectName("pushButton")
        self.textEdit = QtWidgets.QTextEdit(self.tab)
        self.textEdit.setGeometry(QtCore.QRect(10, 170, 141, 31))
        self.textEdit.setObjectName("textEdit")
        self.tabWidget.addTab(self.tab, "")
        '''
        self.tab_2 = QtWidgets.QWidget()
        self.tab_2.setObjectName("tab_2")
        self.label_2 = QtWidgets.QLabel(self.tab_2)
        self.label_2.setGeometry(QtCore.QRect(320, 150, 141, 141))
        self.label_2.setObjectName("label_2")
        self.label_3 = QtWidgets.QLabel(self.tab_2)
        self.label_3.setGeometry(QtCore.QRect(380, 230, 141, 141))
        self.label_3.setObjectName("label_3")
        self.pushButton_2 = QtWidgets.QPushButton(self.tab_2)
        self.pushButton_2.setGeometry(QtCore.QRect(100, 180, 75, 23))
        self.pushButton_2.setObjectName("pushButton_2")
        self.pushButton_3 = QtWidgets.QPushButton(self.tab_2)
        self.pushButton_3.setGeometry(QtCore.QRect(10, 180, 75, 23))
        self.pushButton_3.setObjectName("pushButton_3")

        self.comboBox = QtWidgets.QComboBox(self.tab_2)
        self.comboBox.setGeometry(QtCore.QRect(650, 40, 131, 21))
        self.comboBox.setObjectName("comboBox")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        #–ó–¥–µ—Å—å –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É: self.comboBox.addItem("")

        self.pushButton_4 = QtWidgets.QPushButton(self.tab_2)
        self.pushButton_4.setGeometry(QtCore.QRect(700, 180, 75, 23))
        self.pushButton_4.setObjectName("pushButton_4")
        self.textEdit_2 = QtWidgets.QTextEdit(self.tab_2)
        self.textEdit_2.setGeometry(QtCore.QRect(650, 0, 131, 31))
        self.textEdit_2.setObjectName("textEdit_2")
        self.pushButton_5 = QtWidgets.QPushButton(self.tab_2)
        self.pushButton_5.setGeometry(QtCore.QRect(700, 70, 75, 23))
        self.pushButton_5.setObjectName("pushButton_5")
        
        # –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä
        self.progressBar = QtWidgets.QProgressBar(self.tab_2)
        self.progressBar.setGeometry(QtCore.QRect(650, 100, 131, 23))
        self.progressBar.setObjectName("progressBar")
        self.progressBar.setMinimum(0)
        self.progressBar.setMaximum(100)
        self.progressBar.setValue(0)
        
        # –î–æ–±–∞–≤–ª—è–µ–º –ª–µ–π–±–ª –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞
        self.label_status = QtWidgets.QLabel(self.tab_2)
        self.label_status.setGeometry(QtCore.QRect(650, 125, 131, 16))
        self.label_status.setObjectName("label_status")
        self.label_status.setText("–ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ")
        
        # –î–æ–±–∞–≤–ª—è–µ–º —á–µ–∫–±–æ–∫—Å –¥–ª—è –ø—Ä–æ–∫—Å–∏
        self.checkBox_proxy = QtWidgets.QCheckBox(self.tab_2)
        self.checkBox_proxy.setGeometry(QtCore.QRect(650, 145, 131, 17))
        self.checkBox_proxy.setObjectName("checkBox_proxy")
        self.checkBox_proxy.setText("–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–∫—Å–∏")
        self.checkBox_proxy.setChecked(True)  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω
        
        self.verticalLayoutWidget_4 = QtWidgets.QWidget(self.tab_2)
        self.verticalLayoutWidget_4.setGeometry(QtCore.QRect(490, 10, 151, 151))
        self.verticalLayoutWidget_4.setObjectName("verticalLayoutWidget_4")
        self.verticalLayout_4 = QtWidgets.QVBoxLayout(self.verticalLayoutWidget_4)
        self.verticalLayout_4.setContentsMargins(0, 0, 0, 0)
        self.verticalLayout_4.setObjectName("verticalLayout_4")
        self.label_6 = QtWidgets.QLabel(self.verticalLayoutWidget_4)
        self.label_6.setText("")
        self.label_6.setObjectName("label_6")
        self.verticalLayout_4.addWidget(self.label_6)
        self.verticalLayoutWidget_5 = QtWidgets.QWidget(self.tab_2)
        self.verticalLayoutWidget_5.setGeometry(QtCore.QRect(330, 10, 151, 151))
        self.verticalLayoutWidget_5.setObjectName("verticalLayoutWidget_5")
        self.verticalLayout_5 = QtWidgets.QVBoxLayout(self.verticalLayoutWidget_5)
        self.verticalLayout_5.setContentsMargins(0, 0, 0, 0)
        self.verticalLayout_5.setObjectName("verticalLayout_5")
        self.label_5 = QtWidgets.QLabel(self.verticalLayoutWidget_5)
        self.label_5.setText("")
        self.label_5.setObjectName("label_5")
        self.verticalLayout_5.addWidget(self.label_5)
        self.verticalLayoutWidget_6 = QtWidgets.QWidget(self.tab_2)
        self.verticalLayoutWidget_6.setGeometry(QtCore.QRect(170, 10, 151, 151))
        self.verticalLayoutWidget_6.setObjectName("verticalLayoutWidget_6")
        self.verticalLayout_6 = QtWidgets.QVBoxLayout(self.verticalLayoutWidget_6)
        self.verticalLayout_6.setContentsMargins(0, 0, 0, 0)
        self.verticalLayout_6.setObjectName("verticalLayout_6")
        self.label_4 = QtWidgets.QLabel(self.verticalLayoutWidget_6)
        self.label_4.setText("")
        self.label_4.setObjectName("label_4")
        self.verticalLayout_6.addWidget(self.label_4)
        self.verticalLayoutWidget_7 = QtWidgets.QWidget(self.tab_2)
        self.verticalLayoutWidget_7.setGeometry(QtCore.QRect(10, 10, 151, 151))
        self.verticalLayoutWidget_7.setObjectName("verticalLayoutWidget_7")
        self.verticalLayout_7 = QtWidgets.QVBoxLayout(self.verticalLayoutWidget_7)
        self.verticalLayout_7.setContentsMargins(0, 0, 0, 0)
        self.verticalLayout_7.setObjectName("verticalLayout_7")
        self.label = QtWidgets.QLabel(self.verticalLayoutWidget_7)

        self.checkBox = QtWidgets.QCheckBox(self.tab_2)
        self.checkBox.setGeometry(QtCore.QRect(10, 160, 70, 17))
        self.checkBox.setText("")
        self.checkBox.setObjectName("checkBox")
        self.checkBox_2 = QtWidgets.QCheckBox(self.tab_2)
        self.checkBox_2.setGeometry(QtCore.QRect(170, 160, 70, 17))
        self.checkBox_2.setText("")
        self.checkBox_2.setObjectName("checkBox_2")
        self.checkBox_3 = QtWidgets.QCheckBox(self.tab_2)
        self.checkBox_3.setGeometry(QtCore.QRect(330, 160, 70, 17))
        self.checkBox_3.setText("")
        self.checkBox_3.setObjectName("checkBox_3")
        self.checkBox_4 = QtWidgets.QCheckBox(self.tab_2)
        self.checkBox_4.setGeometry(QtCore.QRect(490, 160, 70, 17))
        self.checkBox_4.setText("")
        self.checkBox_4.setObjectName("checkBox_4")

        #self.spinBox = QtWidgets.QSpinBox(self.tab_2)
        #self.spinBox.setGeometry(QtCore.QRect(650, 70, 42, 22))
        #self.spinBox.setMinimum(3)
        #self.spinBox.setObjectName("spinBox")

        self.textEdit = QtWidgets.QTextEdit(self.tab_2)
        self.textEdit.setGeometry(QtCore.QRect(340, 180, 121, 21))
        self.textEdit.setObjectName("textEdit")
        self.label_7 = QtWidgets.QLabel(self.tab_2)
        self.label_7.setGeometry(QtCore.QRect(200, 180, 131, 16))
        self.label_7.setObjectName("label_7")
        
        # –ó–∞–º–µ–Ω—è–µ–º —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞
        self.pushButton_choose_file = QtWidgets.QPushButton(self.tab_2)
        self.pushButton_choose_file.setGeometry(QtCore.QRect(340, 180, 121, 21))
        self.pushButton_choose_file.setObjectName("pushButton_choose_file")
        self.pushButton_choose_file.setText("–í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª...")
        self.pushButton_choose_file.setContextMenuPolicy(QtCore.Qt.CustomContextMenu)
        self.pushButton_choose_file.customContextMenuRequested.connect(self.show_file_context_menu)
        
        # –°–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª—É
        self.textEdit = QtWidgets.QTextEdit(self.tab_2)
        self.textEdit.setGeometry(QtCore.QRect(340, 180, 121, 21))
        self.textEdit.setObjectName("textEdit")
        self.textEdit.setVisible(False)  # –°–∫—Ä—ã–≤–∞–µ–º —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ
        
        #self.label_8 = QtWidgets.QLabel(self.tab_2)
        #self.label_8.setGeometry(QtCore.QRect(490, 180, 191, 20))
        #self.label_8.setObjectName("label_8")

        self.label.setText("")
        self.label.setObjectName("label")
        self.verticalLayout_7.addWidget(self.label)
        self.tabWidget.addTab(self.tab_2, "")
        MainWindow.setCentralWidget(self.centralwidget)
        self.statusbar = QtWidgets.QStatusBar(MainWindow)
        self.statusbar.setObjectName("statusbar")
        MainWindow.setStatusBar(self.statusbar)

        self.retranslateUi(MainWindow)
        self.tabWidget.setCurrentIndex(1)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)

        self.add_functions()

    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        MainWindow.setWindowTitle(_translate("MainWindow", "Test_layout"))
        self.label_9.setText(_translate("MainWindow", "–í–≤–µ–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–∫—Å–∏:"))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab), _translate("MainWindow", "–ü—Ä–æ–∫—Å–∏"))
        '''
        item = self.tableWidget.horizontalHeaderItem(0)
        item.setText(_translate("MainWindow", "ID"))
        item = self.tableWidget.horizontalHeaderItem(1)
        item.setText(_translate("MainWindow", "–ê–∫—Ç–∏–≤–Ω–æ"))
        item = self.tableWidget.horizontalHeaderItem(2)
        item.setText(_translate("MainWindow", "–†–∞–∑–¥–µ–ª 1"))
        item = self.tableWidget.horizontalHeaderItem(3)
        item.setText(_translate("MainWindow", "–†–∞–∑–¥–µ–ª 2"))
        item = self.tableWidget.horizontalHeaderItem(4)
        item.setText(_translate("MainWindow", "–ê—Ä—Ç–∏–∫—É–ª"))
        item = self.tableWidget.horizontalHeaderItem(5)
        item.setText(_translate("MainWindow", "–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ"))
        item = self.tableWidget.horizontalHeaderItem(6)
        item.setText(_translate("MainWindow", "–û–ø–∏—Å–∞–Ω–∏–µ"))
        item = self.tableWidget.horizontalHeaderItem(7)
        item.setText(_translate("MainWindow", "–ï–¥. –∏–∑–º"))
        item = self.tableWidget.horizontalHeaderItem(8)
        item.setText(_translate("MainWindow", "–†–∞–∑–º–µ—Ä"))
        item = self.tableWidget.horizontalHeaderItem(9)
        item.setText(_translate("MainWindow", "–¶–≤–µ—Ç"))
        item = self.tableWidget.horizontalHeaderItem(10)
        item.setText(_translate("MainWindow", "–¶–µ–Ω–∞"))
        item = self.tableWidget.horizontalHeaderItem(11)
        item.setText(_translate("MainWindow", "–°—Ç–∞—Ä–∞—è —Ü–µ–Ω–∞"))
        self.pushButton.setText(_translate("MainWindow", "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"))
        self.textEdit.setHtml(_translate("MainWindow",
                                         "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0//EN\" \"http://www.w3.org/TR/REC-html40/strict.dtd\">\n"
                                         "<html><head><meta name=\"qrichtext\" content=\"1\" /><style type=\"text/css\">\n"
                                         "p, li { white-space: pre-wrap; }\n"
                                         "</style></head><body style=\" font-family:\'MS Shell Dlg 2\'; font-size:8.25pt; font-weight:400; font-style:normal;\">\n"
                                         "<p style=\" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">–£–∫–∞–∂–∏—Ç–µ ID</p></body></html>"))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab), _translate("MainWindow", "–¢–∞–±–ª–∏—Ü–∞"))
        '''
        self.label_2.setText(_translate("MainWindow", "TextLabel"))
        self.label_3.setText(_translate("MainWindow", "TextLabel"))
        self.pushButton_2.setText(_translate("MainWindow", "–î–∞–ª–µ–µ"))
        self.pushButton_3.setText(_translate("MainWindow", "–ù–∞–∑–∞–¥"))

        self.comboBox.setItemText(0, _translate("MainWindow", "–†–∞–∑–¥–µ–ª—ã"))
        self.comboBox.setItemText(1, _translate("MainWindow", "–ë—Ä—é–∫–∏"))
        self.comboBox.setItemText(2, _translate("MainWindow", "–í–µ—Ä—Ö–Ω—è—è –æ–¥–µ–∂–¥–∞"))
        self.comboBox.setItemText(3, _translate("MainWindow", "–°–≤–∏—Ç–µ—Ä—ã –∏ —Ç–æ–ª—Å—Ç–æ–≤–∫–∏"))
        self.comboBox.setItemText(4, _translate("MainWindow", "–§—É—Ç–±–æ–ª–∫–∏ –∏ —Ä—É–±–∞—à–∫–∏"))
        self.comboBox.setItemText(5, _translate("MainWindow", "–°—É–º–∫–∏"))
        self.comboBox.setItemText(6, _translate("MainWindow", "–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã"))
        self.comboBox.setItemText(7, _translate("MainWindow", "–û–±—É–≤—å"))
        self.comboBox.setItemText(8, _translate("MainWindow", "–ù–∏–∂–Ω–µ–µ –±–µ–ª—å–µ"))
        #–ó–¥–µ—Å—å –î–æ–ø–∏—Å—ã–≤–∞—Ç—å –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É –Ω–∞–ø—Ä–∏–º–µ—Ä: self.comboBox.setItemText(5, _translate("MainWindow", "–ù–æ—Å–∫–∏"))

        self.pushButton_4.setText(_translate("MainWindow", "–ü—Ä–∏–Ω—è—Ç—å"))
        self.pushButton_5.setText(_translate("MainWindow", "–ó–∞–≥—Ä—É–∑–∏—Ç—å"))
        self.label_7.setText(_translate("MainWindow", "–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã:"))
        #self.label_8.setText(_translate(""))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab_2), _translate("MainWindow", "–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä"))

    def add_functions(self):
        self.pushButton_5.clicked.connect(self.start_prog)
        self.pushButton_2.clicked.connect(self.next_img)
        self.pushButton_3.clicked.connect(self.back_img)
        self.pushButton_4.clicked.connect(self.create_mas)
        self.checkBox.clicked.connect(self.choose_img1)
        self.checkBox_2.clicked.connect(self.choose_img2)
        self.checkBox_3.clicked.connect(self.choose_img3)
        self.checkBox_4.clicked.connect(self.choose_img4)
        self.pushButton_4.clicked.connect(self.create_mas)
        self.pushButton_choose_file.clicked.connect(self.choose_file)

        # self.label.mouseDoubleClickEvent.connect(self.choose_img)
    
    def choose_file(self):
        """–î–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞ —Ç–∞–±–ª–∏—Ü—ã"""
        from PyQt5.QtWidgets import QFileDialog
        
        # –û—Ç–∫—Ä—ã–≤–∞–µ–º –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞
        file_path, _ = QFileDialog.getOpenFileName(
            self.centralwidget,
            "–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª —Ç–∞–±–ª–∏—Ü—ã",
            "",  # –ù–∞—á–∞–ª—å–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
            "Excel —Ñ–∞–π–ª—ã (*.xlsx *.xls);;CSV —Ñ–∞–π–ª—ã (*.csv);;–í—Å–µ —Ñ–∞–π–ª—ã (*.*)"
        )
        
        if file_path:
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—É—Ç—å –≤ —Å–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ
            self.textEdit.setPlainText(file_path)
            # –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏
            import os
            filename = os.path.basename(file_path)
            self.pushButton_choose_file.setText(f"üìÑ {filename}")
            # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å
            self.label_status.setText(f"–í—ã–±—Ä–∞–Ω —Ñ–∞–π–ª: {filename}")
        else:
            self.label_status.setText("–§–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω")
    
    def reset_file_choice(self):
        """–°–±—Ä–æ—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞"""
        self.textEdit.setPlainText("")
        self.pushButton_choose_file.setText("–í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª...")
        self.label_status.setText("–§–∞–π–ª —Å–±—Ä–æ—à–µ–Ω")
    
    def show_file_context_menu(self, position):
        """–ü–æ–∫–∞–∑–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞"""
        from PyQt5.QtWidgets import QMenu
        
        menu = QMenu()
        
        # –î–æ–±–∞–≤–ª—è–µ–º –¥–µ–π—Å—Ç–≤–∏—è
        reset_action = menu.addAction("–°–±—Ä–æ—Å–∏—Ç—å –≤—ã–±–æ—Ä")
        reset_action.triggered.connect(self.reset_file_choice)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–µ–Ω—é
        menu.exec_(self.pushButton_choose_file.mapToGlobal(position))

    def create_mas(self):
        global host_img, f_img
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—ã–±—Ä–∞–Ω –ª–∏ —Ñ–∞–π–ª
        table_url = self.textEdit.toPlainText()
        if not table_url:
            self.label_status.setText("–û—à–∏–±–∫–∞: –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª —Ç–∞–±–ª–∏—Ü—ã!")
            return
            
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        import os
        if not os.path.exists(table_url):
            self.label_status.setText("–û—à–∏–±–∫–∞: —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω!")
            return
            
        if len(host_img) == 0:
            self.label_status.setText("–û—à–∏–±–∫–∞: –Ω–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏!")
            return
            
        # –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
        self.label_status.setText("–°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã...")
        self.progressBar.setValue(50)
        
        res = ""
        res = get_string.to_string(host_img, f_img)

        mas = [
            None,  # 1
            1,  # 2
            self.comboBox.currentText(),  # 3
            None,  # 4
            None,  # 5
            None,  # 6
            None,  # 7
            None,  # 8
            None,  # 9
            None,  # 10
            None,  # 11
            None,  # 12
            res,  # 13
            self.textEdit_2.toPlainText()  # 14
        ]
        # print(mas)
        # input()
        if res == "":
            self.label_status.setText("–û—à–∏–±–∫–∞: –Ω–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π!")
            return

        try:
            table.add_img(mas, table_url)
            self.progressBar.setValue(100)
            self.label_status.setText("–¢–∞–±–ª–∏—Ü–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞!")
        except Exception as e:
            self.label_status.setText(f"–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã: {str(e)}")
            print(f"–û—à–∏–±–∫–∞: {e}")


    def see_img(self, url):
        """–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π"""
        self.current_image_set = url[:4]  # –ú–∞–∫—Å–∏–º—É–º 4 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        
        # –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        self.label.setPixmap(QtGui.QPixmap())
        self.label_4.setPixmap(QtGui.QPixmap())
        self.label_5.setPixmap(QtGui.QPixmap())
        self.label_6.setPixmap(QtGui.QPixmap())
        
        # –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –ø–æ—Ç–æ–∫, –µ—Å–ª–∏ –æ–Ω –∑–∞–ø—É—â–µ–Ω
        if self.image_loader and self.image_loader.isRunning():
            self.image_loader.stop()
            self.image_loader.wait()
        
        # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
        self.image_loader = ImageLoaderThread(self.current_image_set)
        
        # –ü–æ–¥–∫–ª—é—á–∞–µ–º —Å–∏–≥–Ω–∞–ª—ã
        self.image_loader.image_loaded.connect(self.on_image_loaded)
        self.image_loader.image_failed.connect(self.on_image_failed)
        self.image_loader.progress_updated.connect(self.on_progress_updated)
        
        # –ó–∞–ø—É—Å–∫–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
        self.image_loader.start()
        
        # –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
        self.label_status.setText("–ù–∞—á–∏–Ω–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π...")
        self.progressBar.setValue(0)
    
    def on_image_loaded(self, index, filename):
        """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"""
        print(f"–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ {index} –∑–∞–≥—Ä—É–∂–µ–Ω–æ: {filename}")
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏
        self.loaded_images[index] = filename
        
        # –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º –ª–µ–π–±–ª–µ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ–º
        pixmap = QtGui.QPixmap(filename)
        if not pixmap.isNull():
            # –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–¥ —Ä–∞–∑–º–µ—Ä –ª–µ–π–±–ª–∞ (149x149)
            scaled_pixmap = pixmap.scaled(149, 149, QtCore.Qt.KeepAspectRatio, QtCore.Qt.SmoothTransformation)
            
            if index == 0:
                self.label.setPixmap(scaled_pixmap)
            elif index == 1:
                self.label_4.setPixmap(scaled_pixmap)
            elif index == 2:
                self.label_5.setPixmap(scaled_pixmap)
            elif index == 3:
                self.label_6.setPixmap(scaled_pixmap)
    
    def on_image_failed(self, index, error):
        """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"""
        print(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è {index}: {error}")
        
        # –û—Ç–æ–±—Ä–∞–∂–∞–µ–º placeholder –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
        placeholder_pixmap = QtGui.QPixmap(149, 149)
        placeholder_pixmap.fill(QtGui.QColor(240, 240, 240))  # –°–≤–µ—Ç–ª–æ-—Å–µ—Ä—ã–π —Ñ–æ–Ω
        
        # –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏
        painter = QtGui.QPainter(placeholder_pixmap)
        painter.setPen(QtGui.QColor(100, 100, 100))
        painter.drawText(placeholder_pixmap.rect(), QtCore.Qt.AlignCenter, "–û—à–∏–±–∫–∞\n–∑–∞–≥—Ä—É–∑–∫–∏")
        painter.end()
        
        if index == 0:
            self.label.setPixmap(placeholder_pixmap)
        elif index == 1:
            self.label_4.setPixmap(placeholder_pixmap)
        elif index == 2:
            self.label_5.setPixmap(placeholder_pixmap)
        elif index == 3:
            self.label_6.setPixmap(placeholder_pixmap)
    
    def on_progress_updated(self, progress, status):
        """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞"""
        self.progressBar.setValue(progress)
        self.label_status.setText(status)
    
    def cleanup_temp_files(self):
        """–û—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π"""
        import os
        for i in range(10):  # –û—á–∏—â–∞–µ–º —Ñ–∞–π–ª—ã res_0.jpg –¥–æ res_9.jpg
            filename = f"res_{i}.jpg"
            if os.path.exists(filename):
                try:
                    os.remove(filename)
                except:
                    pass

    def start_prog(self):
        global host_img
        global inner
        global f_img
        
        # –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä
        self.progressBar.setValue(0)
        self.label_status.setText("–ù–∞—á–∏–Ω–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É...")
        
        host_img = []
        f_img = []
        self.checkBox.setChecked(False)
        self.checkBox_2.setChecked(False)
        self.checkBox_3.setChecked(False)
        self.checkBox_4.setChecked(False)
        inner = 0
        url = self.textEdit_2.toPlainText()
        
        if url != "":
            print(url)
            
            # –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å - –ø–∞—Ä—Å–∏–Ω–≥ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
            self.progressBar.setValue(10)
            self.label_status.setText("–ü–∞—Ä—Å–∏–Ω–≥ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π...")
            
            img_down = parser.img_parser(url)
            print(img_down)
            
            # –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–∫—Å–∏
            self.progressBar.setValue(20)
            self.label_status.setText("–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–∫—Å–∏...")
            
            texe = self.textEdit_3.toPlainText()
            file = open("proxylist.txt", "w")
            file.write(texe)
            file.close()
            
            # –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å - –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
            self.progressBar.setValue(30)
            self.label_status.setText("–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π...")
            
            # –ü–µ—Ä–µ–¥–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ–∫—Å–∏
            use_proxy = self.checkBox_proxy.isChecked()
            host_img = new_postimg.post_img(img_down, use_proxy)
            
            # –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å - –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
            self.progressBar.setValue(90)
            self.label_status.setText("–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ...")
            
            for i in range(len(host_img)):
                f_img.append(0)

            # –ó–∞–≤–µ—Ä—à–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
            self.progressBar.setValue(100)
            self.label_status.setText("–ì–æ—Ç–æ–≤–æ!")
            
            self.next_img()
        else:
            self.label_status.setText("–í–≤–µ–¥–∏—Ç–µ URL!")

    def choose_img1(self):
        global inner, f_img
        n = inner
        if inner % 4 != 0:
            while inner % 4 != 0:
                inner += 1
        if inner - 4 > len(f_img) - 1:
            self.checkBox.setChecked(False)
            inner = n
            return
        if self.checkBox.isChecked():
            f_img[inner - 4] = max(f_img) + 1
        else:
            f_img[inner - 4] = 0
        inner = n

    def choose_img2(self):
        global inner, f_img
        n = inner
        if inner % 4 != 0:
            while inner % 4 != 0:
                inner += 1
        if inner - 3 > len(f_img) - 1:
            inner = n
            self.checkBox_2.setChecked(False)
            return
        if self.checkBox_2.isChecked():
            f_img[inner - 3] = max(f_img) + 1
        else:
            f_img[inner - 3] = 0
        inner = n
        print(f_img)

    def choose_img3(self):
        global inner, f_img
        n = inner
        if inner % 4 != 0:
            while inner % 4 != 0:
                inner += 1
        if inner - 2 > len(f_img) - 1:
            inner = n
            self.checkBox_3.setChecked(False)
            return
        if self.checkBox_3.isChecked():
            f_img[inner - 2] = max(f_img) + 1
        else:
            f_img[inner - 2] = 0
        inner = n
        print(f_img)

    def choose_img4(self):
        global inner, f_img

        n = inner
        if inner % 4 != 0:
            while inner % 4 != 0:
                inner += 1
        if inner - 1 > len(f_img) - 1:
            inner = n
            self.checkBox_4.setChecked(False)
            return
        if self.checkBox_4.isChecked():
            f_img[inner - 1] = max(f_img) + 1
        else:
            f_img[inner - 1] = 0
        inner = n
        print(f_img)

    def next_img(self):

        global host_img, inner, f_img
        n = len(host_img)
        # print(n)
        if n <= 4:
            return
        else:
            # –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            self.progressBar.setValue(0)
            self.label_status.setText("–ù–∞–≤–∏–≥–∞—Ü–∏—è...")
            
            # –û—á–∏—â–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
            self.cleanup_temp_files()

            new_mas = []
            i = 0

            while (inner < n) and (i < 4):

                new_mas.append(host_img[inner])
                if f_img[inner] != 0:
                    print("hi")
                    if inner % 4 == 0:
                        self.checkBox.setChecked(True)
                    if inner % 4 == 1:
                        self.checkBox_2.setChecked(True)
                    if inner % 4 == 2:
                        self.checkBox_3.setChecked(True)
                    if inner % 4 == 3:
                        self.checkBox_4.setChecked(True)
                else:

                    if inner % 4 == 0:
                        self.checkBox.setChecked(False)
                    if inner % 4 == 1:
                        self.checkBox_2.setChecked(False)
                    if inner % 4 == 2:
                        self.checkBox_3.setChecked(False)
                    if inner % 4 == 3:
                        self.checkBox_4.setChecked(False)
                inner += 1
                i += 1

            if inner % 4 != 0:
                if inner % 4 == 1:
                    self.checkBox_4.setChecked(False)
                    self.checkBox_3.setChecked(False)
                    self.checkBox_2.setChecked(False)
                if inner % 4 == 2:
                    self.checkBox_4.setChecked(False)
                    self.checkBox_3.setChecked(False)
                if inner % 4 == 3:
                    self.checkBox_4.setChecked(False)

            print("a", inner)
            self.see_img(new_mas)

    def back_img(self):
        global host_img, inner
        n = len(host_img)
        # print(n)
        if n <= 4:
            return
        if inner == 4:
            return
        else:
            # –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            self.progressBar.setValue(0)
            self.label_status.setText("–ù–∞–≤–∏–≥–∞—Ü–∏—è –Ω–∞–∑–∞–¥...")
            
            # –û—á–∏—â–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
            self.cleanup_temp_files()
            
            new_mas = []
            i = 0

            if inner % 4 == 0:
                inner -= 8
            else:
                inner = inner - ((inner % 4) + 4)

            while (inner >= 0) and (i < 4):
                new_mas.append(host_img[inner])
                if f_img[inner] != 0:
                    print("hi")
                    if inner % 4 == 0:
                        self.checkBox.setChecked(True)
                    if inner % 4 == 1:
                        self.checkBox_2.setChecked(True)
                    if inner % 4 == 2:
                        self.checkBox_3.setChecked(True)
                    if inner % 4 == 3:
                        self.checkBox_4.setChecked(True)
                else:

                    if inner % 4 == 0:
                        self.checkBox.setChecked(False)
                    if inner % 4 == 1:
                        self.checkBox_2.setChecked(False)
                    if inner % 4 == 2:
                        self.checkBox_3.setChecked(False)
                    if inner % 4 == 3:
                        self.checkBox_4.setChecked(False)
                # print("added", inner)
                inner += 1
                i += 1

            print("b", inner)
            self.see_img(new_mas)

        def choose_img():
            print("Clicked")


if __name__ == "__main__":
    import sys

    app = QtWidgets.QApplication(sys.argv)
    MainWindow = QtWidgets.QMainWindow()
    ui = Ui_MainWindow()
    ui.setupUi(MainWindow)
    MainWindow.show()
    sys.exit(app.exec_())
